<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Module3_health • rfasst</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Module3_health">
<meta property="og:description" content="rfasst">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rfasst</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa-clipboard-list"></span>
     
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Module1_emissions.html">Module1 emissions</a>
    </li>
    <li>
      <a href="../articles/Module2_concentration.html">Module2 concentration</a>
    </li>
    <li>
      <a href="../articles/Module3_health.html">Module3 health</a>
    </li>
    <li>
      <a href="../articles/Module4_agriculture.html">Module4 agriculture</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fas fa-file-code-o"></span>
     
    Reference
  </a>
</li>
<li>
  <a href="../news/index.html">
    <span class="fas fa-newspaper-o"></span>
     
    News
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/JGCRI/rfasst/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Module3_health_files/header-attrs-2.8/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Module3_health</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/JGCRI/rfasst/blob/master/vignettes/Module3_health.Rmd"><code>vignettes/Module3_health.Rmd</code></a></small>
      <div class="hidden name"><code>Module3_health.Rmd</code></div>

    </div>

    
    
<p>The functions in this module estimate adverse health effects attributable to fine particulate matter (PM2.5) and ozone (O3; M6M) exposure, measured as premature mortalities, years of life lost (YLLs), and disability adjusted life years (DALYs). The following code shows as an example, the functions to estimate premature mortalities attributable to PM2.5 and the DALYs associated with ozone exposure (M6M).All the functions associated to this module can be found in the <a href="https://jgcri.github.io/rfasst/reference/index.html">References</a> page.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rfasst)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a> db_path<span class="ot">&lt;-</span><span class="st">"path_to_your_gcam_database"</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a> query_path<span class="ot">&lt;-</span><span class="st">"path_to_your_gcam_queries_file"</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a> db_name<span class="ot">&lt;-</span><span class="st">"name of the database"</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a> prj_name<span class="ot">&lt;-</span><span class="st">"name for a Project to add extracted results to"</span> <span class="co"># (any name should work, avoid spaces just in case) </span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a> scen_name<span class="ot">&lt;-</span><span class="st">"name of the GCAM scenario"</span>,</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a> queries<span class="ot">&lt;-</span><span class="st">"Name of the query file"</span> <span class="co"># (the package includes a default query file that includes all the queries required in every function in the packae, "queries_rfasst.xml")</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># To write the csv files into the output folder:</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>     <span class="fu">m3_get_mort_pm25</span>(db_path,query_path,db_name,prj_name,scen_name,queries,<span class="at">saveOutput=</span>T, <span class="at">map=</span>F) </span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>     <span class="fu">m3_get_daly_o3</span>(db_path,query_path,db_name,prj_name,scen_name,queries,<span class="at">saveOutput=</span>T, <span class="at">map=</span>F) </span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># To save this data by TM5-FASST region in year 2050 as dataframes:</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>     pm25.mort<span class="fl">.2050</span><span class="ot">&lt;-</span>dplyr<span class="sc">::</span><span class="fu">bind_rows</span>(<span class="fu">m3_get_mort_pm25</span>(db_path,query_path,db_name,prj_name,scen_name,queries,<span class="at">saveOutput=</span>F, <span class="at">map=</span>F)) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(year<span class="sc">==</span><span class="dv">2050</span>)</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>     <span class="fu">head</span>(pm25.mort<span class="fl">.2050</span>)</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>     o3.daly<span class="fl">.2050</span><span class="ot">&lt;-</span>dplyr<span class="sc">::</span><span class="fu">bind_rows</span>(<span class="fu">m3_get_daly_o3</span>(db_path,query_path,db_name,prj_name,scen_name,queries,<span class="at">saveOutput=</span>F, <span class="at">map=</span>F)) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(year<span class="sc">==</span><span class="dv">2050</span>)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>     <span class="fu">head</span>(o3.daly<span class="fl">.2050</span>)</span></code></pre></div>
<p>The calculation of premature mortalities is consistent with the Global Burden of Disease 2016 (<a href="https://www.thelancet.com/journals/lancet/article/PIIS0140-6736(12)61766-8/fulltext">Lim et al</a>). Mortalities are estimated for five causes, namely stroke, ischemic heart disease (IHD), chronic obstructive pulmonary disease (COPD), acute lower respiratory illness diseases (ALRI) and lung cancer (LC). As explained in the TM5-FASST documentation paper (<a href="https://acp.copernicus.org/articles/18/16173/2018/acp-18-16173-2018-discussion.html">Van Dingenen et al 2018</a>), cause-specific deaths are estimated following the following equation: <span class="math display">\[Mort_{t,r,c,j}=mo_{r,c,j} \cdot ((RR_{c,j}-1)/RR_{c,j})\cdot Pop_{t,r}\]</span> So premature mortality in period <span class="math inline">\(t\)</span>, region <span class="math inline">\(r\)</span>, for cause <span class="math inline">\(c\)</span>, associated with exposure to pollutant <span class="math inline">\(j\)</span> is calculated as the product between the baseline mortality rate, the change in the RR relative risk of death attributable to a change in population-weighted mean pollutant concentration, and the population exposed.</p>
<ul>
<li><p>Cause-specific baseline mortality rates are taken from the World Health Organization projections <a href="https://www.who.int/healthinfo/global_burden_disease/cod_2008_sources_methods.pdf">WHO 2013</a>.</p></li>
<li><p>For PM2.5, relative risk are estimated based on the Integrated Exposure-Response functions (ERFs) from <a href="https://pubmed.ncbi.nlm.nih.gov/24518036/">Burnett et al 2014</a>. For O3, relative risk is based on the ERFs from <a href="https://www.nejm.org/doi/full/10.1056/nejmoa0803894">Jerret et al 2009</a>.</p></li>
<li><p>Population exposed is cause-specific. We assume that for all the causes adults are exposed (&gt;30 Years) while for ALRI, children under 5 years. Population fractions are calculated from the from the <a href="https://tntcat.iiasa.ac.at/SspDb/dsd?Action=htmlpage&amp;page=welcome">SSP database</a>.</p></li>
</ul>
<p>Years of life lost and DALYs are estimated by transforming premature mortalities into either YLLs or DALYs using constant ratios. YLL-to-Mortalities ratios are based on a reduction in statistical life expectancy (months) per 10µg/m³ increase in anthropogenic PM2.5 (TM5-FASST calculations). DALY-to-Mortalities ratios are estimated using the latest available data on mortailities and DALYs from the Institute for Health Metrics and Evaluation (<a href="http://www.healthdata.org/">IHME</a>). We note that these ratios (both for YLLs and for DALYs) are calculated regionally so they differ across regions.</p>
<p>Economic damages associated to the health impacts are calculated multiplying either the premature mortalities or the years of life lost by the corresponding Value of Statistical Life (VSL) or Value of Statistical Life Year (VSLY). Both the VSL and the VSLY are based on the widely accepted OECD values for 2005. According to the literature, this value ranges between US$1.8 and $4.5 million for VSL. The calculations for all regions are based on the “unit value transfer approach” which adjusts the VSL according to their GDP and GDP growth rates, as detialed in <a href="https://openknowledge.worldbank.org/handle/10986/24440">Narain and Sall 2016</a>. In this version, we assume the income elasticity of both the VSL and the VSLY are equal to 0.8, with no adjustments across regions. A potential regional adjustment of these income elasticities will be explored in further developments of the package. We note that the central OECD values could be adjusted by the user. Finally, the damages reported by the functions use the median values of VSL and VSLY for simplicity. The reporting of Lower and Upper Bounds can be selected by the user, but requires some code changes. The systematic reporting of LB and UB is planned for the next package development.</p>
<p>The following code shows some examples for the monetized premature deaths associated to exposure to PM2.5 and monetized years of life lost attributable to O3 exposure:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/JGCRI/rfasst">rfasst</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org">magrittr</a></span><span class="op">)</span>

 <span class="va">db_path</span><span class="op">&lt;-</span><span class="st">"path_to_your_gcam_database"</span>
 <span class="va">query_path</span><span class="op">&lt;-</span><span class="st">"path_to_your_gcam_queries_file"</span>
 <span class="va">db_name</span><span class="op">&lt;-</span><span class="st">"name of the database"</span>
 <span class="va">prj_name</span><span class="op">&lt;-</span><span class="st">" Name for a Project to add extracted results to"</span> <span class="co"># (any name should work, avoid spaces just in case) </span>
 <span class="va">scen_name</span><span class="op">&lt;-</span><span class="st">"Name of the GCAM scenario"</span>
 <span class="va">queries</span><span class="op">&lt;-</span><span class="st">"Name of the query file"</span> <span class="co"># (the package includes a default query file that includes all the queries required in every function in the packae, "queries_rfasst.xml")</span>

  <span class="co"># To write the csv files into the output folder:</span>

     <span class="fu"><a href="../reference/m3_get_mort_o3_ecoloss.html">m3_get_mort_o3_ecoloss</a></span><span class="op">(</span><span class="va">db_path</span>,<span class="va">query_path</span>,<span class="va">db_name</span>,<span class="va">prj_name</span>,<span class="va">scen_name</span>,<span class="va">queries</span>,saveOutput<span class="op">=</span><span class="cn">T</span>, map<span class="op">=</span><span class="cn">F</span><span class="op">)</span> 

     <span class="fu">m3_get_yll_o3_Ecoloss</span><span class="op">(</span><span class="va">db_path</span>,<span class="va">query_path</span>,<span class="va">db_name</span>,<span class="va">prj_name</span>,<span class="va">scen_name</span>,<span class="va">queries</span>,saveOutput<span class="op">=</span><span class="cn">T</span>, map<span class="op">=</span><span class="cn">F</span><span class="op">)</span> 

  <span class="co"># To save this data by TM5-FASST region in year 2050 as dataframes:</span>

     <span class="va">pm25.mort.ecoloss.2050</span><span class="op">&lt;-</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html">bind_rows</a></span><span class="op">(</span><span class="fu"><a href="../reference/m3_get_mort_o3_ecoloss.html">m3_get_mort_o3_ecoloss</a></span><span class="op">(</span><span class="va">db_path</span>,<span class="va">query_path</span>,<span class="va">db_name</span>,<span class="va">prj_name</span>,<span class="va">scen_name</span>,<span class="va">queries</span>,saveOutput<span class="op">=</span><span class="cn">F</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">year</span><span class="op">==</span><span class="fl">2050</span><span class="op">)</span>
     <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">pm25.mort.ecoloss.2050</span><span class="op">)</span>

     <span class="va">o3.yll.ecoloss.2050</span><span class="op">&lt;-</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html">bind_rows</a></span><span class="op">(</span><span class="fu">m3_get_yll_o3_Ecoloss</span><span class="op">(</span><span class="va">db_path</span>,<span class="va">query_path</span>,<span class="va">db_name</span>,<span class="va">prj_name</span>,<span class="va">scen_name</span>,<span class="va">queries</span>,saveOutput<span class="op">=</span><span class="cn">F</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">year</span><span class="op">==</span><span class="fl">2050</span><span class="op">)</span>
     <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">o3.yll.ecoloss.2050</span><span class="op">)</span></code></pre></div>
<p>The complete list of outputs generated by the suite of functions that form this module is listed below:</p>
<ul>
<li><code>PM25_MORT_[scenario]_[year].csv</code></li>
<li><code>PM25_YLL_[scenario]_[year].csv</code></li>
<li><code>PM25_DALY_[scenario]_[year].csv</code></li>
<li><code>PM25_MORT_ECOLOSS_[scenario]_[year].csv</code></li>
<li><code>PM25_YLL_ECOLOSS__[scenario]_[year].csv</code></li>
<li><code>O3_MORT_[scenario]_[year].csv</code></li>
<li><code>O3_YLL_[scenario]_[year].csv</code></li>
<li><code>O3_DALY_[scenario]_[year].csv</code></li>
<li><code>O3_MORT_ECOLOSS_[scenario]_[year].csv</code></li>
<li><code>O3_YLL_ECOLOSS__[scenario]_[year].csv</code></li>
</ul>
<p>As in Module 2, for all these functions, the package allows to produce different figures and/or animations, generated using the <a href="https://github.com/JGCRI/rmap">rmap</a> package documented in the following <a href="jgcri.github.io/rmap/">page</a>. To generate these maps, the user needs to include the <code>map=T</code> parameter, and they will be generated and stored in the corresponding output sub-directory. As an example for this module, the following map shows the premature mortalities attributable to PM2.5 exposure by cause in 2050.</p>
<!-------------------------->
<!-------------------------->
<p align="center" style="font-size:18px;">
<em>Premature Mortalities attributable to PM2.5 concentration by cause in 2050 (#)</em>
</p>
<p align="center">
<img src="https://raw.githubusercontent.com/JGCRI/rfasst/main/vignettes/vignetteFigs/PM2.5_mort_2050.png"></p>
<!-------------------------->
<!-------------------------->
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Jon Sampedro, Zarrar Khan, Chris Vernon.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
